<section class="card tab-card">
    <header class="card-header">
        <h3>Información personal</h3>
        <p class="muted">Provincia, cantón y parroquia</p>
    </header>

    <div class="card-content">
        <div class="form grid-2">

            <!-- Provincia -->
            <div class="form-row">
                <label class="label">Provincia</label>
                <select class="select" [(ngModel)]="selectedProvinciaId" (change)="onProvinciaChange()">
          <option value="" disabled selected>Selecciona una provincia</option>
          <option
            *ngFor="let p of provincias; trackBy: trackById"
            [value]="p.id">
            {{ p.nombre }}
          </option>
        </select>
            </div>

            <!-- Cantón -->
            <div class="form-row">
                <label class="label">Cantón</label>
                <select class="select" [(ngModel)]="selectedCantonId" (change)="onCantonChange()" [disabled]="!cantones.length">
          <option value="" disabled selected>Selecciona un cantón</option>
          <option
            *ngFor="let c of cantones; trackBy: trackById"
            [value]="c.id">
            {{ c.nombre }}
          </option>
        </select>
                <small class="hint" [class.warn]="!cantones.length">
          {{ !cantones.length ? 'Selecciona una provincia primero.' : '' }}
        </small>
            </div>

            <!-- Parroquia -->
            <div class="form-row span-2">
                <label class="label">Parroquia</label>
                <select class="select" [(ngModel)]="selectedParishId" [disabled]="!parroquias.length">
          <option value="" disabled selected>Selecciona una parroquia</option>
          <option
            *ngFor="let parr of parroquias; trackBy: trackById"
            [value]="parr.id">
            {{ parr.nombre }}
          </option>
        </select>
                <small class="hint" [class.warn]="!parroquias.length">
          {{ !parroquias.length ? 'Selecciona un cantón para ver parroquias.' : '' }}
        </small>
            </div>

            <div class="divider span-2"></div>

            <!-- Fecha de nacimiento -->
            <div class="form-row">
                <label class="label">Fecha de nacimiento</label>
                <input type="date" class="select date" [max]="today" [(ngModel)]="viewBirthdate" />
            </div>

            <!-- Número telefónico (+593 fijo a la izquierda) -->
            <div class="form-row">
                <label class="label">Número telefónico</label>
                <div class="phone-input">
                    <span class="prefix-chip">EC&nbsp;<b>+593</b></span>
                    <input type="tel" inputmode="numeric" class="phone" placeholder="0999998888" [(ngModel)]="viewPhone" (input)="onPhoneInput()" maxlength="10" />
                </div>
                <small class="hint">
          Solo números. Se enviará como: <b>+593</b> + tu número (sin el 0 inicial).
        </small>
            </div>

            <div class="divider span-2"></div>

            <!-- Sexo -->
            <div class="form-row">
                <label class="label">Sexo</label>
                <select class="select" [(ngModel)]="sexo">
          <option value="" selected>Selecciona una opción</option>
          <option *ngFor="let opt of sexoOptions" [value]="opt.value">
            {{ opt.label }}
          </option>
        </select>
            </div>

            <!-- Estado civil -->
            <div class="form-row">
                <label class="label">Estado civil</label>
                <select class="select" [(ngModel)]="estadoCivil">
          <option value="" selected>Selecciona una opción</option>
          <option *ngFor="let opt of estadoCivilOptions" [value]="opt.value">
            {{ opt.label }}
          </option>
        </select>
            </div>

            <!-- Discapacidad -->
            <div class="form-row">
                <label class="label">¿Tiene discapacidad?</label>
                <select class="select" [(ngModel)]="discapacidad" (change)="onDiscapacidadChange()">
          <option value="" selected>Selecciona una opción</option>
          <option *ngFor="let opt of discapacidadOptions" [value]="opt.value">
            {{ opt.label }}
          </option>
        </select>
            </div>

            <!-- Bloque dependiente: solo cuando discapacidad === 'si' -->
            <ng-container *ngIf="discapacidad === 'si'">
                <!-- Tipo de discapacidad -->
                <div class="form-row">
                    <label class="label">Tipo de discapacidad</label>
                    <select class="select" [(ngModel)]="discapacidadPermanente">
            <option value="" selected>Selecciona una opción</option>
            <option *ngFor="let opt of discapacidadPermanenteOptions" [value]="opt">
              {{ opt }}
            </option>
          </select>
                </div>

                <!-- Asistencia a establecimiento -->
                <div class="form-row span-2">
                    <label class="label">¿Asiste a algún establecimiento de discapacidad?</label>
                    <select class="select" [(ngModel)]="asistenciaDisc">
            <option value="" selected>Selecciona una opción</option>
            <option *ngFor="let opt of asistenciaDiscOptions" [value]="opt.value">
              {{ opt.label }}
            </option>
          </select>
                </div>
            </ng-container>

        </div>
    </div>

    <footer class="card-footer">
        <button type="button" class="btn btn-primary" (click)="onSubmitPersonal()">
      Guardar cambios
    </button>
    </footer>
</section>